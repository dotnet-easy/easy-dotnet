---
title: Hive
date: 2023-04-21 15:10:30
permalink: /pages/10261/
sidebar: false
article: false
---
::: note å¼€æºåœ°å€
Githubï¼š[https://docs.hivedb.dev/#/](https://docs.hivedb.dev/#/)
::: 
[![img](https://raw.githubusercontent.com/hivedb/hive/master/.github/logo_transparent.svg?sanitize=true)](https://raw.githubusercontent.com/hivedb/hive/master/.github/logo_transparent.svg?sanitize=true)

## å¿«é€Ÿã€æ„‰å¿«å’Œå®‰å…¨çš„ NoSQL æ•°æ®åº“

[![GitHub å·¥ä½œæµçŠ¶æ€ï¼ˆåˆ†æ”¯ï¼‰](https://camo.githubusercontent.com/e9355ce8e5d8e86e2db80b535893ed4dfe183ebbd5805becaedf39b793fa9604/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f776f726b666c6f772f7374617475732f6869766564622f686976652f4461727425323043492f6e6e64623f6c6162656c3d7465737473266c6162656c436f6c6f723d333333393430266c6f676f3d676974687562)](https://github.com/hivedb/hive/actions) [![ç¼–è§£ç å™¨åˆ†æ”¯](https://camo.githubusercontent.com/82fb23bd564de5e6a7c07d0755a01fb2924134e6c28d627efaf626496e127389/68747470733a2f2f696d672e736869656c64732e696f2f636f6465636f762f632f6769746875622f6869766564622f686976652f6e6e64623f6c6162656c436f6c6f723d333333393430266c6f676f3d636f6465636f76266c6f676f436f6c6f723d7768697465)](https://codecov.io/gh/hivedb/hive) [![é…’é¦†ç‰ˆ](https://camo.githubusercontent.com/5781a71262883f7e68ce8665f357dd2f97f0bf89befda233d5b0af29eb6ea3e0/68747470733a2f2f696d672e736869656c64732e696f2f7075622f762f686976653f6c6162656c3d7075622e646576266c6162656c436f6c6f723d333333393430266c6f676f3d64617274)](https://pub.dev/packages/hive) [![GitHub](https://camo.githubusercontent.com/58606a99ea13b002ff77a550d8bfde6ba83619c8cfa8e716608fe0c54bd3c78e/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f6c6963656e73652f6869766564622f686976653f636f6c6f723d253233303037413838266c6162656c436f6c6f723d333333393430266c6f676f3d617061636865)](https://github.com/hivedb/hive/blob/master/LICENSE)

Hive æ˜¯ä¸€ä¸ªç”¨çº¯ Dart ç¼–å†™çš„è½»é‡çº§ä¸”è¶…å¿«çš„é”®å€¼å¯¹æ•°æ®åº“ã€‚å—[Bitcask](https://en.wikipedia.org/wiki/Bitcask)å¯å‘ã€‚

[æ–‡æ¡£å’Œæ ·æœ¬](https://docs.hivedb.dev/) ğŸ“–

### åœ¨ä½ å¼€å§‹ä¹‹å‰

è€ƒè™‘ä½¿ç”¨[Isar](https://github.com/isar/isar)ï¼Œè¿™æ˜¯ Hive ä½œè€…çš„ Flutter æ•°æ®åº“ï¼Œå®ƒåœ¨å„æ–¹é¢éƒ½éå¸¸å‡ºè‰²ï¼

## ç‰¹å¾

- ğŸš€è·¨å¹³å°ï¼šç§»åŠ¨ç«¯ã€æ¡Œé¢ç«¯ã€æµè§ˆå™¨
- âš¡å‡ºè‰²çš„æ€§èƒ½ï¼ˆå‚è§[åŸºå‡†](https://github.com/hivedb/hive#benchmark)ï¼‰
- â¤ï¸ç®€å•ã€å¼ºå¤§ã€ç›´è§‚çš„ API
- ğŸ”’å†…ç½®å¼ºå¤§çš„åŠ å¯†åŠŸèƒ½
- ğŸˆ **æ²¡æœ‰**åŸç”Ÿä¾èµ–
- ğŸ”‹åŒ…æ‹¬ç”µæ± 

## å…¥é—¨

æŸ¥çœ‹[å¿«é€Ÿå…¥é—¨](https://docs.hivedb.dev/)æ–‡æ¡£ä»¥å¼€å§‹ä½¿ç”¨ã€‚

## ç”¨æ³•

æ‚¨å¯ä»¥åƒä½¿ç”¨åœ°å›¾ä¸€æ ·ä½¿ç”¨ Hiveã€‚æ²¡æœ‰å¿…è¦ç­‰å¾… `Futures`ã€‚

```dart
var box = Hive.box('myBox');

box.put('name', 'David');

var name = box.get('name');

print('Name: $name');
```

## BoxCollections

`BoxCollections`æ˜¯ä¸€ç»„å¯ä»¥åƒæ™®é€šç›’å­ä¸€æ ·ä½¿ç”¨çš„ç›’å­ï¼Œé™¤äº†å®ƒä»¬æ˜¾ç€æé«˜äº†ç½‘ç»œé€Ÿåº¦ã€‚å®ƒä»¬æ”¯æŒä¸€æ¬¡æ‰“å¼€å’Œå…³é—­é›†åˆçš„æ‰€æœ‰æ¡†ï¼Œå¹¶æ›´æœ‰æ•ˆåœ°å°†æ•°æ®å­˜å‚¨åœ¨ç½‘ç»œä¸Šçš„ç´¢å¼•æ•°æ®åº“ä¸­ã€‚

æ­¤å¤–ï¼Œå®ƒä»¬è¿˜å…¬å¼€äº†å¯ç”¨äºåŠ é€Ÿ Web ä¸Šå¤§é‡æ•°æ®åº“äº‹åŠ¡çš„äº‹åŠ¡ã€‚

åœ¨ `dart:io`å¹³å°ä¸Šï¼ŒBoxCollections æˆ– Transactions æ²¡æœ‰æ€§èƒ½æå‡ã€‚åªæœ‰ BoxCollections å¯èƒ½å¯¹æŸäº›ç›’å­å±‚æ¬¡ç»“æ„å’Œå¼€å‘ç»éªŒæœ‰ç”¨ã€‚

```dart
// Create a box collection
  final collection = await BoxCollection.open(
    'MyFirstFluffyBox', // Name of your database
    {'cats', 'dogs'}, // Names of your boxes
    path: './', // Path where to store your boxes (Only used in Flutter / Dart IO)
    key: HiveCipher(), // Key to encrypt your boxes (Only used in Flutter / Dart IO)
  );

  // Open your boxes. Optional: Give it a type.
  final catsBox = collection.openBox<Map>('cats');

  // Put something in
  await catsBox.put('fluffy', {'name': 'Fluffy', 'age': 4});
  await catsBox.put('loki', {'name': 'Loki', 'age': 2});

  // Get values of type (immutable) Map?
  final loki = await catsBox.get('loki');
  print('Loki is ${loki?['age']} years old.');

  // Returns a List of values
  final cats = await catsBox.getAll(['loki', 'fluffy']);
  print(cats);

  // Returns a List<String> of all keys
  final allCatKeys = await catsBox.getAllKeys();
  print(allCatKeys);

  // Returns a Map<String, Map> with all keys and entries
  final catMap = await catsBox.getAllValues();
  print(catMap);

  // delete one or more entries
  await catsBox.delete('loki');
  await catsBox.deleteAll(['loki', 'fluffy']);

  // ...or clear the whole box at once
  await catsBox.clear();

  // Speed up write actions with transactions
  await collection.transaction(
    () async {
      await catsBox.put('fluffy', {'name': 'Fluffy', 'age': 4});
      await catsBox.put('loki', {'name': 'Loki', 'age': 2});
      // ...
    },
    boxNames: ['cats'], // By default all boxes become blocked.
    readOnly: false,
  );
```

## å­˜å‚¨å¯¹è±¡

Hive ä¸ä»…æ”¯æŒåŸè¯­ã€åˆ—è¡¨å’Œæ˜ å°„ï¼Œè¿˜æ”¯æŒæ‚¨å–œæ¬¢çš„ä»»ä½• Dart å¯¹è±¡ã€‚åœ¨å­˜å‚¨å¯¹è±¡ä¹‹å‰ï¼Œæ‚¨éœ€è¦ç”Ÿæˆä¸€ä¸ªç±»å‹é€‚é…å™¨ã€‚

```dart
@HiveType(typeId: 0)
class Person extends HiveObject {

  @HiveField(0)
  String name;

  @HiveField(1)
  int age;
}
```

æ‰©å±• `HiveObject`æ˜¯å¯é€‰çš„ï¼Œä½†å®ƒæä¾›äº†æ–¹ä¾¿çš„æ–¹æ³•ï¼Œä¾‹å¦‚ `save()`å’Œ `delete()`ã€‚

```dart
var box = await Hive.openBox('myBox');

var person = Person()
  ..name = 'Dave'
  ..age = 22;
box.add(person);

print(box.getAt(0)); // Dave - 22

person.age = 30;
person.save();

print(box.getAt(0)) // Dave - 30
```

## Hive â¤ï¸ Flutter

Hive æ˜¯åœ¨è€ƒè™‘ Flutter çš„æƒ…å†µä¸‹ç¼–å†™çš„ã€‚å¦‚æœæ‚¨çš„åº”ç”¨éœ€è¦ä¸€ä¸ªè½»é‡çº§çš„æ•°æ®å­˜å‚¨ï¼Œå®ƒæ˜¯ä¸€ä¸ªå®Œç¾çš„é€‰æ‹©ã€‚æ·»åŠ æ‰€éœ€çš„ä¾èµ–é¡¹å¹¶åˆå§‹åŒ– Hive åï¼Œæ‚¨å¯ä»¥åœ¨é¡¹ç›®ä¸­ä½¿ç”¨ Hiveï¼š

```dart
import 'package:hive/hive.dart';
import 'package:hive_flutter/hive_flutter.dart';

class SettingsPage extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return ValueListenableBuilder(
      valueListenable: Hive.box('settings').listenable(),
      builder: (context, box, widget) {
        return Switch(
          value: box.get('darkMode'),
          onChanged: (val) {
            box.put('darkMode', val);
          }
        );
      },
    );
  }
}
```

ç›’å­æ˜¯ç¼“å­˜çš„ï¼Œå› æ­¤é€Ÿåº¦è¶³å¤Ÿå¿«ï¼Œå¯ä»¥ç›´æ¥åœ¨ `build()`Flutter å°éƒ¨ä»¶çš„æ–¹æ³•ä¸­ä½¿ç”¨ã€‚

### æœ¬æœº AES åŠ å¯†å®ç°

ä½¿ç”¨ Flutter æ—¶ï¼ŒHive æ”¯æŒä½¿ç”¨[package:cryptography](https://pub.dev/packages/cryptography) å’Œ[package:cryptography_flutter](https://pub.dev/packages/cryptography_flutter)è¿›è¡Œæœ¬æœºåŠ å¯†ã€‚

åŸç”Ÿ AES å®ç°æå¤§åœ°åŠ é€Ÿäº†åŠ å¯†ç›’å­çš„æ“ä½œã€‚

è¯·æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ“ä½œï¼š

1. å‘ pubspec.yaml æ·»åŠ ä¾èµ–é¡¹

```yaml
dependencies:
  cryptography_flutter: ^2.0.2
```

1. å¯ç”¨æœ¬æœºå®ç°

```dart
import 'package:cryptography_flutter/cryptography_flutter.dart';

void main() {
  // Enable Flutter cryptography
  FlutterCryptography.enable();

  // ....
}
```

## åŸºå‡†

|                       1000 æ¬¡è¯»å–è¿­ä»£                        |                       1000 æ¬¡å†™å…¥è¿­ä»£                        |
| :----------------------------------------------------------: | :----------------------------------------------------------: |
| [![img](https://raw.githubusercontent.com/hivedb/hive/master/.github/benchmark_read.png)](https://raw.githubusercontent.com/hivedb/hive/master/.github/benchmark_read.png) | [![img](https://raw.githubusercontent.com/hivedb/hive/master/.github/benchmark_write.png)](https://raw.githubusercontent.com/hivedb/hive/master/.github/benchmark_write.png) |
| SharedPreferences åœ¨è¯»å–æ€§èƒ½æ–¹é¢ä¸ Hive ç›¸å½“ã€‚SQLite çš„è¡¨ç°è¦å·®å¾—å¤šã€‚ | åœ¨å†™å…¥æˆ–åˆ é™¤æ–¹é¢ï¼ŒHive å¤§å¤§ä¼˜äº SQLite å’Œ SharedPreferencesã€‚ |

åŸºå‡†æµ‹è¯•æ˜¯åœ¨è£…æœ‰ Android Q çš„ Oneplus 6T ä¸Šæ‰§è¡Œçš„ã€‚æ‚¨å¯ä»¥[è‡ªå·±è¿è¡ŒåŸºå‡†æµ‹è¯•](https://github.com/hivedb/hive_benchmark)ã€‚

*ä»¥ä¸€ç²’ç›æ¥è¡¡é‡è¿™ä¸ªåŸºå‡†ã€‚å¾ˆéš¾å®¢è§‚åœ°æ¯”è¾ƒæ•°æ®åº“ï¼Œå› ä¸ºå®ƒä»¬æ˜¯ä¸ºä¸åŒç›®çš„è€Œåˆ¶ä½œçš„ã€‚

### æ‰§ç…§

```
Copyright 2019 Simon Leier

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

   http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
```

